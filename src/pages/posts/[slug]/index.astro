---
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
    const posts = await getCollection('posts');

    return posts.map((post) => ({
        params: { slug: post.id },
        props: { post },
    }));
}

import Left from '@/assets/icons/left.svg';

import Root from '@/layouts/Root.astro';
import Header from '@/components/post/Header.astro';

const { post } = Astro.props;
const { Content } = await render(post);
---

<>
    <link rel="canonical" href={import.meta.env.SITE + '/posts/' + post.id} />
    <meta property="og:title" content={post.data.title} />
    <meta
        property="og:url"
        content={import.meta.env.SITE + '/posts/' + post.id}
    />
    <meta
        property="og:image"
        content={import.meta.env.SITE + '/posts/' + post.id + '/og.png'}
    />
    <meta property="og:type" content="article" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={post.data.title} />
    <meta
        name="twitter:image"
        content={import.meta.env.SITE + '/posts/' + post.id + '/og.png'}
    />
    <Root>
        <div class="flex flex-col gap-6">
            <a
                href="/"
                class="flex flex-row items-center gap-2 text-sm text-stone-700 hover:text-stone-800 dark:text-stone-400 dark:hover:text-stone-300"
            >
                <Left class="h-3 w-3" aria-hidden />
                <span>back</span>
            </a>
            <Header post={post} />
            <div class="prose prose-sm prose-light dark:prose-dark max-w-none">
                <Content />
            </div>
        </div>
    </Root>
</>
